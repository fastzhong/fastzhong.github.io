+++
title = "Go æé€Ÿä¸Šæ‰‹"
date = 2020-09-03T01:08:47+08:00
readingTime = true
categories = ["ç¼–ç¨‹"]
tags = ["go"]
toc = true
+++

30 åˆ†é’Ÿæé€Ÿä¸Šæ‰‹ Go

<!--more-->

![Go](/images/golang/golang.png#center)

## Go ç‰¹æ€§

Go ä¸æ˜¯ä¸€ç§â€œé¢ è¦†æ€§â€çš„ï¼Œè€Œæ›´å¤šæ˜¯â€œä¼˜é€‰æ€§â€çš„ç¼–ç¨‹è¯­è¨€ï¼š

-   feature-simplicity from C
-   readability from Python
-   static-typed & compiled like C++/Java
-   GC from Java
-   language built-in concurrencyï¼šgoroutines

æƒ³äº†è§£çš„å¯ä»¥å‚è€ƒï¼š[Why Go Is Successful (aka Simplicity is Complicated)](https://www.youtube.com/watch?v=k9Zbuuo51go)

## Go å¼€å‘ç¯å¢ƒ

### å®‰è£… Go (mac)

```bash
> brew install go
> go env GOROOT
> export GOPATH=$HOME/workspace/go
> export GOROOT=/usr/local/opt/go/libexec
> export GO111MODULE="on"
> mkdir -p $GOPATH/{src,bin}
> go version
go version go1.16.2 darwin/amd64
```

è®¾ç½®å¥½ç¯å¢ƒå˜é‡ `GOROOT` å’Œ `GOPATH`ï¼š

```bash
# .zshrc or .bashrc
# Go
export GOPATH=$HOME/workspace/go
export GOROOT=/usr/local/opt/go/libexec
```

`GOROOT` ä¹ƒ Go å®‰è£…çš„æœ¬åœ°ç›®å½•

Go ä¾ç…§â€œeverything under one roofâ€åŸåˆ™ï¼Œ`GOPATH` ä¹ƒ Go å·¥ä½œåŒºï¼ˆworkspaceï¼‰ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç›®å½•ï¼ˆé€šå¸¸å»ºè®®æ˜¯ä¸€ä¸ªï¼‰ï¼Œå­˜æ”¾é¡¹ç›®æœ‰å…³çš„ä¸€åˆ‡ï¼šæºä»£ç ï¼Œç¬¬ä¸‰æ–¹åº“ï¼Œç¼–è¯‘ä¸­é—´æ–‡ä»¶ï¼Œç­‰ç­‰ï¼ŒGOPATH ç›®å½•ä¸‹ï¼Œçº¦å®šæœ‰ä¸‰ä¸ªå­ç›®å½•ï¼š

-   srcï¼šå­˜æ”¾æºä»£ç 
-   pkgï¼šå­˜æ”¾ç¼–è¯‘æ—¶ï¼Œç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶
-   binï¼šå­˜æ”¾ç¼–è¯‘åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ ï¼ˆé€šå¸¸ä¼šå°† \$GOPATH\bin åŠ å…¥ç¯å¢ƒå˜é‡ PATH ä¸­ï¼Œä»¥æ–¹ä¾¿æ‰§è¡Œç¼–è¯‘åçš„ç¨‹åºï¼‰

è®¾ç½®æ–¹å¼ï¼š

-   ä¸€ä¸ªå·¥ä½œåŒºï¼Œå…¨å±€å¤šä¸ªé¡¹ç›®å…±äº«ï¼Œç®€å•ï¼Œä½†éš”ç¦»ä¸å¤Ÿ
-   æ¯ä¸ªé¡¹ç›®ä½¿ç”¨å•ç‹¬å·¥ä½œåŒºï¼Œæ¯æ¬¡è¦å•ç‹¬æŒ‡å®š GOPATH
-   é¡¹ç›®/ä¸šåŠ¡å’Œç¬¬ä¸‰æ–¹åº“åˆ†å¼€æ”¾ç½®ï¼Œé…ç½®ä¸¤ä¸ª GOPATH

`GOBIN` æ˜¯ç¼–è¯‘ä¹‹åï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„å®‰è£…ç›®å½•ã€‚å¦‚æœè®¾ç½®äº† GOBINï¼Œç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶å°†ä¸ä¼šå®‰è£…åˆ° GOPATH ä¸‹çš„ bin ç›®å½•ã€‚å¦‚æœ GOPATH åŒ…å«äº†å¤šä¸ªç›®å½•ï¼Œåˆ™å¿…é¡»è®¾ç½® GOBINã€‚

ğŸ’¡ GOPATH ç®€å•ï¼Œä½†éš¾ä»¥å¤„ç†ç‰ˆæœ¬ä¾èµ–å’Œéš”ç¦»ï¼ŒGo1.14 åæ¨èä½¿ç”¨ Go Moduleï¼ˆç±»ä¼¼ pip/npm/mavenï¼ŒGo è¯­è¨€çš„ä¾èµ–è§£å†³æ–¹æ¡ˆï¼‰ï¼Œå–ä»£ GOPATH

### VS Code

1. å®‰è£… Go æ’ä»¶ï¼š

![vs code go](/images/vscode/go.png)

2. å®‰è£… Go å¸¸ç”¨ tools å’Œæ‰©å±•ï¼š

âŒ˜ â‡§ P å”¤å‡ºä¸‡èƒ½é¢æ¿ï¼Œé€‰ Goï¼š

![Go tools](/images/golang/tools1.png#center)

ç„¶åå…¨é€‰ï¼š

![Go tools](/images/golang/tools2.png#center)

åœ¨ VS Code çš„ Terminal å¯ä»¥çœ‹åˆ°å®‰è£…çš„è¿‡ç¨‹ï¼š

```bash
Tools environment: GOPATH=/Users/zhonglun/workspace/go/bin
Installing 10 tools at /Users/zhonglun/workspace/go/bin/bin in module mode.
  gopkgs
  go-outline
  gotests
  gomodifytags
  impl
  goplay
  dlv
  dlv-dap
  staticcheck
  gopls

Installing github.com/uudashr/gopkgs/v2/cmd/gopkgs (/Users/zhonglun/workspace/go/bin/bin/gopkgs) SUCCEEDED
Installing github.com/ramya-rao-a/go-outline (/Users/zhonglun/workspace/go/bin/bin/go-outline) SUCCEEDED
Installing github.com/cweill/gotests/gotests (/Users/zhonglun/workspace/go/bin/bin/gotests) SUCCEEDED
Installing github.com/fatih/gomodifytags (/Users/zhonglun/workspace/go/bin/bin/gomodifytags) SUCCEEDED
Installing github.com/josharian/impl (/Users/zhonglun/workspace/go/bin/bin/impl) SUCCEEDED
Installing github.com/haya14busa/goplay/cmd/goplay (/Users/zhonglun/workspace/go/bin/bin/goplay) SUCCEEDED
Installing github.com/go-delve/delve/cmd/dlv (/Users/zhonglun/workspace/go/bin/bin/dlv) SUCCEEDED
Installing github.com/go-delve/delve/cmd/dlv@master (/Users/zhonglun/workspace/go/bin/bin/dlv-dap) SUCCEEDED
Installing honnef.co/go/tools/cmd/staticcheck (/Users/zhonglun/workspace/go/bin/bin/staticcheck) SUCCEEDED
Installing golang.org/x/tools/gopls (/Users/zhonglun/workspace/go/bin/bin/gopls) SUCCEEDED

All tools successfully installed. You are ready to Go :).
```

å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œ go get å®‰è£…ã€‚

### Goland

è®¾ç½®å¥½ GOROOT å’Œ GOPATH å³å¯ã€‚

## Go é¡¹ç›®å·¥ç¨‹ç»“æ„

åœ¨ç¼–ç å¼€å‘ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹ä¸‹ go çš„é¡¹ç›®ç»“æ„ã€‚

åŸºäº Go Moduleï¼Œå¯ä»¥åœ¨ä»»æ„ä½ç½®åˆ›å»ºä¸€ä¸ª Go é¡¹ç›®ï¼Œè€Œä¸å†åƒä»¥å‰ä¸€æ ·å±€é™åœ¨$GOPATH/src ç›®å½•ä¸‹ã€‚å‡è®¾è¦åˆ›å»ºä¸€ä¸ª hello é¡¹ç›®ï¼Œå®ƒä½äº~/workspace/go ç›®å½•ä¸‹ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤å³å¯åˆ›å»ºä¸€ä¸ª Go Module å·¥ç¨‹ï¼š

```bash
[I] âœ go version
go version go1.16.2 darwin/amd64
(base) 06:15:07 in ~ via â¬¢ v15.13.0 via ğŸ…’ base
[I] âœ cd ~/workspace/go
(base) 06:17:45 in ~/workspace/go via ğŸ¹ v1.16.2 via ğŸ…’ base
[I] âœ mkdir hello
~/workspace/go via ğŸ¹ v1.15.5
[I] âœ go mod init fastzhong.com/hello
go: creating new go.mod: module fastzhong.com/hello
~/workspace/go via ğŸ¹ v1.15.5
[I] âœ ls
go.mod  pkg

~/workspace/go via ğŸ¹ v1.15.5
[I] âœ cat go.mod
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ File: go.mod
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   â”‚ module fastzhong.com/hello
   2   â”‚
   3   â”‚ go 1.15
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

å½“å‰ç”Ÿæˆçš„ Go Module å·¥ç¨‹åªæœ‰ä¸€ä¸ª go.mod æ–‡ä»¶ï¼Œgo.mod æ–‡ä»¶æ˜¯ Go è¯­è¨€å·¥å…·é“¾ç”¨äºç®¡ç† Go è¯­è¨€é¡¹ç›®çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸ç”¨æ‰‹åŠ¨ä¿®æ”¹å®ƒï¼ŒGo è¯­è¨€çš„å·¥å…·é“¾ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æ›´æ–°ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬çš„é¡¹ç›®æ·»åŠ ä¸€ä¸ªæ–°çš„ç¬¬ä¸‰æ–¹åº“/åŒ…çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼š

```go
import (
    "github.com/gohugoio/hugo/commands"
)
```

ä»¥ä¸Šå¼•å…¥çš„ github.com/gohugoio/hugo/commands è¿™ä¸ªåŒ…æ˜¯å±äº github.com/gohugoio/hugo/è¿™ä¸ª Go Module çš„ã€‚

ç›¸åº”çš„å¯ä»¥åœ¨æˆ‘ä»¬è‡ªå·±çš„ Go Module å·¥ç¨‹é‡Œåˆ›å»ºä¸€äº›åŒ…(å…¶å®å°±æ˜¯å­ç›®å½•)ï¼Œæ¯”å¦‚ lib1ã€lib2ï¼Œé‚£ä¹ˆå®ƒçš„å¯¹åº”çš„åŒ…å°±æ˜¯ fastzhong.com/hello/lib1ï¼Œå…¶ä»–åŒ…åªæœ‰é€šè¿‡è¿™ä¸ªåŒ…åæ‰èƒ½ä½¿ç”¨ lib1 åŒ…ä¸­çš„å‡½æ•°æ–¹æ³•ç­‰ã€‚

.  
â”œâ”€â”€ go.mod  
â”œâ”€â”€ lib1  
â”œâ”€â”€ lib2  
â”œâ”€â”€ pkg  
â””â”€â”€ main.go

æ‰€ä»¥æ¯ä¸ªå­ç›®å½•éƒ½æ˜¯ä¸€ä¸ªåŒ…ï¼Œå­ç›®å½•é‡Œå¯ä»¥æ”¾ go æºæ–‡ä»¶ã€‚

ç¬¬ä¸‰æ–¹åŒ…çš„è·å–å¯ä»¥é€šè¿‡ go getï¼š

```bash

```

## Hello World

åœ¨~/workspace/go/hello ä¸‹æ·»åŠ ä¸€ä¸ª main.go æ–‡ä»¶ï¼š

```go
package main

import (
    "fmt"
)

func main() {
    fmt.Println("Hello World!")
}
```

```bash
//è¿è¡Œmain
workspace/go/hello via ğŸ¹ v1.15.5 took 6s
[I] âœ go run main.go
Hello World!

// æ‰“åŒ…å®‰è£…
workspace/go/hello via ğŸ¹ v1.15.5
[I] âœ go install fastzhong.com/hello

// ç›´æ¥è¿è¡Œå¯æ‰§è¡ŒäºŒè¿›åˆ¶
workspace/go/hello via ğŸ¹ v1.15.5
[I] âœ hello
Hello World!
```

## ç¨‹åºç»“æ„

ä»ä¸Šé¢çš„ hello.go å¯ä»¥çœ‹å‡ºï¼š

âœ¦ æºæ–‡ä»¶ä»¥ .go ä¸ºåç¼€åå­˜å‚¨

âœ¦ packageï¼ˆåŒ…ï¼‰  
Go ä½¿ç”¨ packageï¼ˆåŒ…ï¼‰æ¥ç®¡ç†ä»£ç ï¼Œpackage ç‰¹æ€§ï¼š

-   ä¸€ä¸ªç›®å½•ä¸‹çš„åŒçº§æ–‡ä»¶å±äºä¸€ä¸ª package
-   åŒ…åä¸ç›®å½•åå¯ä»¥ä¸åŒï¼Œä½†æ˜¯é€šå¸¸ä¼šä¿æŒä¸€è‡´
-   package æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª Go æºç æ–‡ä»¶çš„é›†åˆï¼ˆå†…å®¹åŒ…å«äº†å˜é‡ï¼Œstructï¼Œç±»å‹ï¼Œæ¥å£ï¼Œå‡½æ•°ï¼‰ï¼ŒGo çš„åŒ…æ›´åƒ Pythonï¼Œè€Œé Javaï¼ˆå†…å®¹ä»¥ class ä¸ºåŸºæœ¬å•ä½ï¼Œä¸‡äº‹çš† classï¼‰ï¼Œæ¯ä¸ªç¨‹åºå¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªèº«çš„åŒ…æˆ–è€…å¼•ç”¨å…¶å®ƒçš„åŒ…ï¼š
    -   å£°æ˜ï¼šåœ¨æºæ–‡ä»¶çš„ç¬¬ä¸€è¡Œå£°æ˜æ˜è¯¥æ–‡ä»¶å±äºå“ªä¸€ä¸ªåŒ…ï¼Œå¦‚ï¼špackage myserviceï¼Œæ³¨æ„åŒ…åæ²¡æœ‰å±‚çº§æ¦‚å¿µ
    -   å¼•ç”¨ï¼šéœ€è¦åŠ å…¥å¼•ç”¨è·¯å¾„ï¼ˆç›®å½•åï¼‰ï¼Œå¦‚ â€œimport xxx.com/a/b/myserviceâ€œ å°±å¯¹åº”ç€ src ç›®å½•ä¸‹çš„ xxx.com/a/b/myserviceï¼Œè¿™ç‚¹å’Œ Java ä¸åŒï¼ŒGo çš„å£°æ˜å’Œå¼•ç”¨è·¯å¾„æ˜¯åˆ†å¼€çš„
-   ç¨‹åºçš„å…¥å£æ˜¯ main åŒ…çš„ main å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰ main åŒ…ï¼Œåˆ™ä¸ä¼šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œmain åŒ…ä¸å¯è¢«å¼•ç”¨
-   Go è¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼ Java Public å’Œ Private çš„æ¦‚å¿µï¼Œå¦‚æœç±»å‹/æ¥å£/æ–¹æ³•/å‡½æ•°/å­—æ®µçš„é¦–å­—æ¯å¤§å†™ï¼ˆä¾‹å¦‚ fmt.<font color="orange">P</font>rintï¼‰ï¼Œåˆ™æ˜¯ Public çš„ï¼Œå¯¹å…¶ä»– package å¯è§ï¼Œå¦‚æœé¦–å­—æ¯å°å†™ï¼Œåˆ™æ˜¯ Private çš„ï¼Œå¯¹å…¶ä»– package ä¸å¯è§

âœ¦ Go ç¼–è¯‘ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªé™æ€å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé™¤äº† glibc å¤–æ²¡æœ‰å…¶ä»–å¤–éƒ¨ä¾èµ–

## æ•°æ®ç»“æ„

âœ¦ åŸºç¡€ç±»å‹
å¸ƒå°”ç±»å‹ï¼šbool  
æ•´å‹ï¼šbyteã€intã€int8ã€int16ã€uintã€uintptr  
æµ®ç‚¹ç±»å‹ï¼šfloat32ã€float64  
å¤æ•°ç±»å‹ï¼šcomplex64ã€complex128  
å­—ç¬¦ä¸²ï¼šstring  
å­—ç¬¦ç±»å‹ï¼šrune  
é”™è¯¯ç±»å‹ï¼šerror

<font color="orange">error</font> Go å†…å»ºé”™è¯¯ç±»å‹ï¼Œå…¶å®æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼ˆinterfaceï¼‰

âœ¦ å¤åˆç±»å‹  
æŒ‡é’ˆï¼špointer  
æ•°ç»„ï¼šarray  
åˆ‡ç‰‡ï¼šslice  
å­—å…¸ï¼šmap  
é€šé“ï¼šchan  
ç»“æ„ä½“ï¼šstruct  
æ¥å£ï¼šinterface

ğŸ’¡<font color="orange">struct</font> & <font color="orange">pointer</font> å’Œ C/C++å¾ˆç±»ä¼¼ ğŸ˜…ï¼Œç†è§£æŒ‡é’ˆçš„å…³é”®ç‚¹æ˜¯å†…å­˜æ¨¡å‹ï¼ˆå˜é‡/æ•°æ®åœ¨å†…å­˜ä¸­çš„æ ·å­ï¼‰ã€‚

```go
func add(num int) {
	num += 1
}

func realAdd(num *int) {
	*num += 1
}

func main() {
	num := 100
	add(num)
	fmt.Println(num)  // 100ï¼Œnum æ²¡æœ‰å˜åŒ–

	realAdd(&num)
	fmt.Println(num)  // 101ï¼ŒæŒ‡é’ˆä¼ é€’ï¼Œnum è¢«ä¿®æ”¹
}
```

<font color="orange">slice</font> ç›¸å½“äºåŠ¨æ€æ•°ç»„ï¼Œå…¶ç”¨æ³•å’Œ Python ç±»ä¼¼ï¼š

```go
a := [...]int{1, 2, 3, 4, 5}
s1 := a[2:4]   // 3ï¼Œ4
s2 := a[1:5]   // 2ï¼Œ3ï¼Œ4ï¼Œ5
s3 := a[:]     // a
s4 := a[:4]    // 1ï¼Œ2ï¼Œ3ï¼Œ4
s5 := s2[:]    // 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5
s6 := a[2:4:5] // 3
```

## é€»è¾‘ç»“æ„

âœ¦ if/els & switch

```go
if x > 0 {
    return "positive"
} else {
    return "negative"
}

switch t := i.(type) {
case bool:
    return "I'm a bool"
case int:
    return "I'm an int"
default:
    return "Don't know type %T", t
}
```

âœ¦ for

```go
-   for init; condition; post { } // ç±»ä¼¼ C
-   for condition { } // ç›¸å½“äº while
-   for { } // æ— é™å¾ªç¯
```

```go
for i := 0; i < 10; i++ {
    sum += i
}
```

å¾ªç¯ä½“å†…å¯ä»¥æœ‰ <font color="orange">break</font> å’Œ <font color="orange">continue</font>

âœ¦ goto

```go
if skipped {
  goto doLast
}
// è·³è¿‡ä¸Šé¢çš„ä»£ç å—
doLast:
// ç«‹å³æ‰§è¡Œçš„ä»£ç å—
```

âœ¦ range

å’Œ Python ç±»ä¼¼ï¼š

```go
list := []string{"a", "b", "c", "d", "e", "f"}
for i, v := range list {
    // i is the element index
    // v is the element value
}
```

## å†…ç½®å‡½æ•°

âœ¦ main() & init()

å’Œ Python ç±»ä¼¼ï¼Œinit çš„ä½œç”¨åœ¨äºåˆå§‹åŒ–ï¼š

```md
-   init å‡½æ•°å…ˆäº main å‡½æ•°è‡ªåŠ¨æ‰§è¡Œï¼Œä¸èƒ½è¢«å…¶ä»–å‡½æ•°è°ƒç”¨ï¼›
-   init å‡½æ•°æ²¡æœ‰è¾“å…¥å‚æ•°ã€è¿”å›å€¼ï¼›
-   æ¯ä¸ªåŒ…å¯ä»¥æœ‰å¤šä¸ª init å‡½æ•°ï¼Œæ¯ä¸ªæºæ–‡ä»¶ä¹Ÿå¯ä»¥æœ‰å¤šä¸ª init å‡½æ•°ï¼›
-   åŒä¸€ä¸ªåŒ…çš„ init æ‰§è¡Œé¡ºåºï¼Œgolang æ²¡æœ‰æ˜ç¡®å®šä¹‰ï¼Œç¼–ç¨‹æ—¶è¦æ³¨æ„ç¨‹åºä¸è¦ä¾èµ–è¿™ä¸ªæ‰§è¡Œé¡ºåºï¼›
-   ä¸åŒåŒ…çš„ init å‡½æ•°æŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šæ‰§è¡Œé¡ºåºï¼›
```

âœ¦ defer

defer ä¿®é¥°çš„ä»£ç ï¼Œä¸ä¼šé©¬ä¸Šæ‰§è¡Œï¼Œè€Œæ˜¯åœ¨å½“å‰å‡½æ•°è¿”å›æˆ–é€€å‡ºä¹‹å‰æ‰§è¡Œï¼Œå¸¸ç”¨äºå…³é—­/é‡Šæ”¾èµ„æºï¼Œå¦‚æ–‡ä»¶æè¿°ç¬¦ï¼Œæ•°æ®åº“é“¾æ¥ï¼Œé”ç­‰ï¼š

```go
func main() {
	for i := 0; i < 5; i++ {
		defer fmt.Println(i)
	}
}

$ go run main.go
4
3
2
1
```

âœ¦ panic() & recover()

panic æŠ›å‡ºå¼‚å¸¸ï¼Œrecover ç”¨æ¥ä¿˜è·ï¼Œå¹¶æŠ›å‘ä¸Šä¸€å±‚ï¼š

```go
func action() {
    defer fmt.Println("action completed")
    defer func() {
        if err := recover(); err != nil {
            fmt.Println(err)
            // do something to recover
        }
    }()

    panic("something goes wrong !!!")
}
// something goes wrong !!!
// action completed
```

âœ¦ new() & make()

-   make å’Œ new éƒ½æ˜¯ golang ç”¨æ¥åˆ†é…å†…å­˜çš„å…§å»ºå‡½æ•°ï¼Œä¸”åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œmake å³åˆ†é…å†…å­˜ï¼Œä¹Ÿåˆå§‹åŒ–å†…å­˜ã€‚new åªæ˜¯å°†å†…å­˜æ¸…é›¶ï¼Œå¹¶æ²¡æœ‰åˆå§‹åŒ–å†…å­˜ã€‚
-   make è¿”å›çš„è¿˜æ˜¯å¼•ç”¨ç±»å‹æœ¬èº«ï¼›è€Œ new è¿”å›çš„æ˜¯æŒ‡å‘ç±»å‹çš„æŒ‡é’ˆã€‚
-   make åªèƒ½ç”¨æ¥åˆ†é…åŠåˆå§‹åŒ–ç±»å‹ä¸º sliceï¼Œmapï¼Œchannel çš„æ•°æ®ï¼›new å¯ä»¥åˆ†é…ä»»æ„ç±»å‹çš„æ•°æ®ã€‚

è¿˜æœ‰å…¶å®ƒçš„ï¼š closeï¼Œdeleteï¼Œlenï¼Œcapï¼Œcopyï¼Œappendï¼Œprintï¼Œprintlnï¼Œcomplexï¼Œrealï¼Œimag

## å˜é‡

```go
// å•ä¸ªå˜é‡
var i int = 0
var i = 0
i := 0

// å¤šä¸ªå˜é‡
var i, j, k int

// å¸¸é‡:
const (
    a = iota    // a=0
    b           // å’Œ a ä¸€æ ·ï¼Œä¸ç”¨é‡å¤ b = iotaï¼Œiotaä¼šè‡ªå¢ï¼Œb=1
    c           // c=2
    d = 1
    f           // å’Œ d ä¸€æ ·ï¼Œf=1
)
```

## å‡½æ•°

åœ¨ Go è¯­è¨€ä¸­å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå®ƒä½œä¸ºä¸€ä¸ªå˜é‡ã€ç±»å‹ã€å‚æ•°ã€è¿”å›å€¼ï¼Œç”šè‡³å¯ä»¥å»å®ç°ä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯ Go è¯­è¨€ä¸­å‡½æ•°ä¸æ”¯æŒé‡è½½ã€åµŒå¥—å’Œé»˜è®¤å‚æ•°ã€‚

âœ¦ å‡½æ•°å®šä¹‰ï¼š

```go
func function_name( [parameter list] ) [return_types] {
// å‡½æ•°ä½“
}
```

âœ¦ ä¸å®šé•¿åº¦å˜å‚ï¼š

```go
func test(num ...int){
    fmt.Println(num) // [1 2 3 4]
}

test(1,2,3,4)
```

âœ¦ å¤šè¿”å›å€¼ï¼š

```go
func test() (string,int,bool){
    return "Hello World", 100, true
}

v1, v2, v3 := test()

fmt.Println(v1, v2, v3) // Hello World 100 true
```

âœ¦ å‘½åè¿”å›å€¼ï¼š

```go
func test() (a string, b bool, c int) {
    a = "Golang"
    b = false
    c = 200
    return
}

v1, v2, v3 := test()

fmt.Println(v1, v2, v3) // Golang false 200
```

âœ¦ ä½œä¸ºå˜é‡ï¼š

```go
func test(){
    // å‡½æ•°ä½“
}

funcTest := test
fmt.Println(funcTest())
```

âœ¦ åŒ¿åå‡½æ•°ï¼š

```go
test := func(){
    // å‡½æ•°ä½“
}
```

âœ¦ ä½œä¸ºç±»å‹ï¼š

```go
package main

import "fmt"

type iAdder func(int, int) int

func main(){
    var adder iAdder = func(a int, b int) int {
        return a + b
    }

    fmt.Println(adder(1,2)) // 3
}
```

âœ¦ é—­åŒ…ï¼š

```go
package main

import "fmt"

// ä½¿ç”¨ é—­åŒ…å®ç° æ–æ³¢é‚£å¥‘æ•°åˆ—
func fibonacci() func() int {
    a, b := 0, 1

    return func() int {
        a, b = b, a +b
        return a
    }
}

func main() {
    f := fibonacci()

    fmt.Println(f()) // 1
    fmt.Println(f()) // 1
    fmt.Println(f()) // 2
    fmt.Println(f()) // 3
    fmt.Println(f()) // 5
}
```

ğŸ’¡ ç†è§£é—­åŒ…çš„å…³é”®ç‚¹æ˜¯ä½œç”¨åŸŸ

## ç»“æ„ä½“(struct) å’Œæ–¹æ³•(methods)

ä¸ C è¯­è¨€ä¸­çš„ struct æˆ–å…¶ä»–é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­çš„ class ç±»ä¼¼ï¼Œ

```go
type Student struct {
	name string
	age  int
}

func (stu *Student) hello(person string) string {
	return fmt.Sprintf("hello %s, I am %s", person, stu.name)
}

func main() {
	stu := &Student{
		name: "Tom",
	}
	msg := stu.hello("Jack")
	fmt.Println(msg) // hello Jack, I am Tom
}
```

## æ¥å£(interfaces)

å’Œ Java ç±»ä¼¼ï¼Œæ¥å£é¿å…å¤šç»§æ‰¿ï¼ˆmulti-inheritanceï¼‰ï¼Œè€Œé‡‡ç”¨ç»„åˆæ–¹å¼ï¼ˆcompositionï¼‰ã€‚æ¥å£å®šä¹‰äº†ä¸€ç»„æŠ½è±¡è¡Œä¸º - æ–¹æ³•ï¼ˆmethodï¼‰ï¼š

```go
type Person interface {
    getName() string
    getAge() int
}

type Student struct {
	name string
	age  int
}

func (stu *Student) getName() string {
	return stu.name
}

func (stu *Student) getAge() int {
	return stu.age
}

func main() {
	var p Person = &Student{
		name: "Tom",
		age:  18,
	}

	fmt.Println(p.getName()) // Tom
}
```

-   æ¥å£ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä¸€ä¸ªç±»å‹å¯ä»¥å®ç°å¤šä¸ªæ¥å£
-   ä¸éœ€è¦æ˜¾å¼åœ°å£°æ˜å®ç°äº†å“ªä¸€ä¸ªæ¥å£ï¼Œåªéœ€è¦ç›´æ¥å®ç°è¯¥æ¥å£å¯¹åº”çš„æ–¹æ³•å³å¯
-   æ–¹æ³•å’Œå‡½æ•°ä¸åŒï¼Œä¸å¯ç›´æ¥è°ƒç”¨ï¼Œå¿…é¡»é€šè¿‡å®ç°æ¥å£çš„å®ä¾‹è°ƒç”¨

---

<i class="fas fa-map-marker-alt"></i>&nbsp;&nbsp; å°ç»“ï¼šå¦‚æœæœ‰ç¼–ç¨‹ç»éªŒï¼ˆJavaï¼ŒJavascriptï¼ŒC++ï¼ŒPythonï¼‰ï¼Œä¸Šæ‰‹ Go ç¡®å®å¾ˆå¿«ï¼ŒGo å€Ÿé‰´äº†å®ƒä»¬çš„ç‰¹ç‚¹ã€‚

ãŠ« æ›´æ·±å…¥çš„æ•™ç¨‹ï¼š

-   [Go è¯­è¨€è®¾è®¡ä¸å®ç°](https://draveness.me/golang/)
-   [Go è¯­è¨€é«˜çº§ç¼–ç¨‹(Advanced Go Programming)](https://chai2010.gitbooks.io/advanced-go-programming-book/content/)

![Go](/images/golang/roadmap.png#center)
